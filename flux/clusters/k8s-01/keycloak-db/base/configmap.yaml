apiVersion: v1
kind: ConfigMap
metadata:
  name: keycloak-db-init-sql
data:
  init.sql: |
    \set ON_ERROR_STOP
    \echo "EXECUTING DB INIT SCRIPT"

    \c keycloak-db
    
    GRANT SELECT ON ALL TABLES IN SCHEMA public TO "mosaic";
    
    ALTER TABLE keycloak                     OWNER TO "keycloak";
    ALTER TABLE apps                         OWNER TO "keycloak";
    ALTER TABLE apps_keycloak                OWNER TO "keycloak";
    ALTER TABLE keycloak_group_properties    OWNER TO "keycloak";
    ALTER TABLE keycloak_category_properties OWNER TO "keycloak";
    ALTER TABLE keycloak_features            OWNER TO "keycloak";
    ALTER TABLE keycloak_dependencies        OWNER TO "keycloak";
    ALTER TABLE databasechangelog            OWNER TO "keycloak";
    ALTER TABLE databasechangeloglock        OWNER TO "keycloak";
